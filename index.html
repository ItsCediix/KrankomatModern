<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Krankomat Modern</title>
    <!-- Load Tailwind CDN first -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configure Tailwind -->
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            // THEME CONFIGURATION
            // Uses CSS variables managed by js/colors.js to allow dynamic theming
            colors: {
              indigo: {
                50: 'var(--color-primary-50)',
                100: 'var(--color-primary-100)',
                200: 'var(--color-primary-200)',
                300: 'var(--color-primary-300)',
                400: 'var(--color-primary-400)',
                500: 'var(--color-primary-500)',
                600: 'var(--color-primary-600)', // Main Brand Color
                700: 'var(--color-primary-700)',
                800: 'var(--color-primary-800)',
                900: 'var(--color-primary-900)',
                950: 'var(--color-primary-950)',
              },
              slate: {
                50: '#f8fafc',
                100: '#f1f5f9',
                200: '#e2e8f0',
                300: '#cbd5e1',
                400: '#94a3b8',
                500: '#64748b',
                600: '#475569',
                700: '#334155',
                800: '#1e293b',
                900: '#0f172a',
                950: '#020617',
              }
            },
            animation: {
              'scale-in': 'scale-in 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards',
              'fade-in': 'fade-in 0.5s ease-out forwards',
            }
          },
        },
        safelist: [
          'translate-x-1',
          'translate-x-7',
          'text-green-600',
          'dark:text-green-400',
          'text-slate-400',
          'dark:text-slate-500',
          'italic',
          'font-medium',
          'opacity-50',
          'cursor-not-allowed'
        ],
        plugins: [],
      }
    </script>
    <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="/index.css">
</head>
  <body class="bg-slate-50 dark:bg-slate-900 min-h-screen text-slate-800 dark:text-slate-300 font-sans transition-colors duration-300 flex flex-col">
    <noscript>You need to enable JavaScript to run this app.</noscript>

    <!-- Modals -->
    <div id="terms-modal-container"></div>
    <div id="settings-modal-container"></div>
    <div id="mensa-modal-container"></div>
    <div id="calendar-modal-container"></div>
    <div id="toast-container" class="fixed bottom-4 right-4 z-[200] flex flex-col gap-2 pointer-events-none"></div>

    <!-- Header -->
    <header class="bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm shadow-sm sticky top-0 z-20 transition-colors duration-300 border-b border-slate-200 dark:border-slate-800">
      <div class="container mx-auto px-4 lg:px-8 py-4">
        <div class="flex items-center justify-between">
          <div class="flex items-center space-x-4">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-indigo-600" viewBox="0 0 24 24">
              <path fill="currentColor" d="M19 14h-3v3h-2v-3h-3v-2h3V9h2v3h3m3-9H2c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h12.1c-.08-.33-.12-.66-.12-1c0-2.71 1.7-5.02 4-6.09V6l-8 5l-8-5h16v2.09c.72.2 1.39.57 2 .9V6c0-1.11-.89-2-2-2m-2 2L12 9L4 5h16Z"/>
            </svg>
            <div>
              <h1 class="text-2xl lg:text-3xl font-bold text-slate-800 dark:text-white">
                Krankomat <span id="app-title-suffix" class="text-indigo-600">WebApp</span>
              </h1>
              <p class="text-xs lg:text-sm text-slate-500 dark:text-slate-400 mt-1 hidden sm:block">
                Das Krankomat-Entwicklerteam: Fabian Flocken, Laurin Bennet Jaetschmann, Marvin Junk und Cederic Langpaap
              </p>
            </div>
          </div>
          <div class="flex items-center space-x-2 sm:space-x-4">
            <button id="verify-btn" class="p-2 rounded-full text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700/60 transition-colors" title="Verifizierung">
                <!-- Icon injected by JS -->
            </button>
            <a id="fileshare-btn" href="https://hawhamburgedu.sharepoint.com/sites/EGov25-Cloud/Freigegebene%20Dokumente/Forms/AllItems.aspx" target="_blank" rel="noopener noreferrer" class="p-2 rounded-full text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700/60 transition-colors" title="Dateifreigabe öffnen">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="currentColor" class="h-6 w-6">
                    <path d="M64 480H448c35.3 0 64-28.7 64-64V160c0-35.3-28.7-64-64-64H288c-10.1 0-19.6-4.7-25.6-12.8L243.2 57.6C231.1 41.5 212.1 32 192 32H64C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64z"/>
                </svg>
            </a>
            <button id="calendar-toggle-btn" class="p-2 rounded-full text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700/60 transition-colors" title="Stundenplan anzeigen">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10zm0-12H5V6h14v2zm-7 5h5v5h-5v-5z"/>
                </svg>
            </button>
            <button id="mensa-toggle-btn" class="p-2 rounded-full text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700/60 transition-colors" title="Mensa-Menü anzeigen">
                <svg class="h-6 w-6" viewBox="130 360 85 100" xmlns="http://www.w3.org/2000/svg" fill="currentColor">
                  <g transform="matrix(1, 0, 0, 1, 112.069527, 358.127716)">
                    <path d="M64.3,63.2c-2.3,3.2-5,7.2-7.9,11.3l14.9,20.8c1.6,2.3,4.8,2.7,7,1l4.5-3.5c2.2-1.7,2.5-4.9,0.7-7L64.3,63.2z"/>
                    <path d="M33.6,49.9l3-0.3c1.1-0.1,2.1,0.4,2.8,1.2l4,5.6c2.5-3,4.9-6.1,7.3-9.2L48,44c-0.7-0.8-0.9-2-0.5-3l1.1-2.9   c1.7-4.6,0.9-9.7-2.1-13.6l-16-20.6c-1.3-1.7-3.7-1.9-5.4-0.5c-1.5,1.3-1.6,3.7-0.4,5.2l13.2,17c0.9,1.2,0.6,2.9-0.7,3.7   c-1.1,0.7-2.6,0.3-3.5-0.7L20.6,11.6c-1.3-1.7-3.7-1.9-5.4-0.5c-1.5,1.3-1.6,3.7-0.4,5.2l13.2,17c0.9,1.2,0.6,2.9-0.7,3.7   c-1.1,0.7-2.6,0.3-3.5-0.7L10.8,19.5c-1.2-1.6-3.5-2.1-5.2-0.9c-1.8,1.2-2.1,3.7-0.8,5.3l16.1,20.6C23.9,48.4,28.7,50.4,33.6,49.9z   "/>
                    <path d="M92.9,7.3c-0.9-2.3-4-2.8-5.5-0.8L57.7,45.2c-9.2,12-17.5,22-27.5,33.3l-5.7,7c-1.8,2.2-1.4,5.5,0.9,7.3l4.5,3.4   c2.4,1.8,5.7,1.2,7.4-1.2c6.4-9.6,21.5-31.8,27.4-39.7l7,4.6c2.8,1.6,6.3,0.7,8-2c3.4-5.6,9.6-17.1,14.1-25.9   C98,23.9,95.2,13.4,92.9,7.3z"/>
                  </g>
                </svg>
            </button>
            <button id="settings-toggle-btn" class="p-2 rounded-full text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700/60 transition-colors" title="Einstellungen">
               <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd" />
               </svg>
            </button>
          </div>
        </div>
      </div>
    </header>

    <main id="main-content" class="container mx-auto p-4 lg:p-8 transition-all duration-500 flex-grow">
      
      <!-- Disclaimer -->
      <div id="disclaimer-container" class="hidden mb-4 p-4 bg-amber-50 dark:bg-amber-900/20 border-l-4 border-amber-400 dark:border-amber-500 rounded-r-lg shadow-md animate-fade-in">
          <div class="flex">
            <div class="py-1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="currentColor" class="h-8 w-8 text-amber-500 dark:text-amber-400 mr-4 flex-shrink-0">
                <path d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224c0-17.7-14.3-32-32-32s-32 14.3-32 32s14.3 32 32 32s32-14.3 32-32z"/>
              </svg>
            </div>
            <div>
              <p class="font-bold text-amber-800 dark:text-amber-200">Hinweis</p>
              <p class="text-sm text-amber-700 dark:text-amber-300">
                Dieses Werkzeug ist eine E-Mail Schreibhilfe. Alle Daten bleiben auf dem Gerät. 
              </p>
            </div>
            <div class="ml-auto pl-3">
              <button id="dismiss-disclaimer-btn" class="text-amber-500 hover:text-amber-700 dark:text-amber-400 dark:hover:text-amber-200 focus:outline-none rounded-full h-8 w-8 flex items-center justify-center transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" fill="currentColor" class="h-5 w-5">
                  <path d="M310.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L160 210.7 54.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L114.7 256 9.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 301.3 265.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L205.3 256 310.6 150.6z"/>
                </svg>
              </button>
            </div>
          </div>
      </div>

      <!-- Config Reminder Banner -->
      <div id="config-banner-container" class="hidden mb-8 p-4 bg-indigo-50 dark:bg-slate-800 border-2 border-dashed border-indigo-300 dark:border-indigo-900 rounded-lg animate-fade-in relative">
          <div class="flex items-start">
             <div class="py-1">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-indigo-500 dark:text-indigo-400 mr-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
             </div>
             <div>
                <p class="font-bold text-indigo-800 dark:text-indigo-200">Konfiguration laden</p>
                <p class="text-sm text-indigo-700 dark:text-indigo-300 mt-1">
                   Haben Sie eine Konfigurationsdatei? Laden Sie Ihre <strong>[Name]_config.json</strong> in den Einstellungen hoch, um Ihr Profil und den Stundenplan wiederherzustellen.
                </p>
                <button id="open-settings-shortcut" class="mt-2 text-sm font-semibold text-indigo-600 hover:text-indigo-800 dark:text-indigo-400 dark:hover:text-indigo-200 underline">
                   Einstellungen öffnen
                </button>
             </div>
             <button id="dismiss-config-banner-btn" class="absolute top-2 right-2 text-indigo-400 hover:text-indigo-600 dark:text-indigo-500 dark:hover:text-indigo-300 focus:outline-none p-2 rounded-full transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" fill="currentColor" class="h-4 w-4">
                  <path d="M310.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L160 210.7 54.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L114.7 256 9.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 301.3 265.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L205.3 256 310.6 150.6z"/>
                </svg>
             </button>
          </div>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-5 gap-8">
        <!-- Left Column: Builder -->
        <div class="lg:col-span-3 space-y-8">
          
          <!-- User Info Panel -->
          <div class="bg-white dark:bg-slate-800 rounded-xl shadow-lg">
            <div class="p-6">
              <h2 class="text-xl font-bold text-slate-800 dark:text-slate-100 border-b border-slate-200 dark:border-slate-700 pb-4 mb-5">
                Allgemeine Informationen
              </h2>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                 <div class="flex flex-col">
                    <label for="firstName" class="mb-1.5 text-sm font-medium text-slate-600 dark:text-slate-400">Vorname</label>
                    <input id="firstName" type="text" class="form-input px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 text-slate-900 dark:text-white">
                 </div>
                 <div class="flex flex-col">
                    <label for="lastName" class="mb-1.5 text-sm font-medium text-slate-600 dark:text-slate-400">Nachname</label>
                    <input id="lastName" type="text" class="form-input px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 text-slate-900 dark:text-white">
                 </div>
              </div>

              <div class="border-t border-slate-200 dark:border-slate-700 mt-4 pt-4 space-y-4">
                  <div class="p-1 flex bg-slate-100 dark:bg-slate-700 rounded-full">
                    <button id="btn-type-krank" class="w-1/2 py-2 text-sm font-semibold rounded-full transition-all duration-300">Krankmeldung</button>
                    <button id="btn-type-gesund" class="w-1/2 py-2 text-sm font-semibold rounded-full transition-all duration-300">Gesundmeldung</button>
                  </div>
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-start">
                     <div class="flex flex-col">
                        <label for="startDate" class="mb-1.5 text-sm font-medium text-slate-600 dark:text-slate-400">Erster Krankheitstag</label>
                        <input id="startDate" type="text" class="form-input px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 text-slate-900 dark:text-white">
                     </div>
                     <div class="flex flex-col">
                        <label for="endDate" class="mb-1.5 text-sm font-medium text-slate-600 dark:text-slate-400">Letzter Krankheitstag (optional)</label>
                        <input id="endDate" type="text" class="form-input px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 text-slate-900 dark:text-white">
                        <button id="btn-today-healthy" class="mt-2 text-sm text-indigo-600 hover:text-indigo-800 dark:text-indigo-400 dark:hover:text-indigo-300 self-start font-medium">heute wieder gesund</button>
                     </div>
                  </div>
              </div>
              <div class="flex justify-end pt-4 mt-2">
                  <button id="btn-reset-date" class="inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md shadow-sm transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-slate-800 focus:ring-indigo-500 text-indigo-700 bg-indigo-100 hover:bg-indigo-200 dark:bg-slate-700 dark:text-indigo-300 dark:hover:bg-slate-600">
                     <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 mr-2">
                       <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" />
                     </svg>
                     Datum zurücksetzen
                  </button>
              </div>
            </div>
          </div>

          <!-- Absence Grid -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
             <!-- Absence Panel -->
             <div class="bg-white dark:bg-slate-800 rounded-xl shadow-lg">
                <div class="p-6">
                   <h2 class="text-xl font-bold text-slate-800 dark:text-slate-100 border-b border-slate-200 dark:border-slate-700 pb-4 mb-5">Heute verpasse ich...</h2>
                   <div id="absence-reasons-container" class="space-y-2">
                      <!-- Injected by JS -->
                   </div>
                </div>
             </div>

             <!-- Details Panel -->
             <div class="bg-white dark:bg-slate-800 rounded-xl shadow-lg">
                <div class="p-6">
                   <h2 class="text-xl font-bold text-slate-800 dark:text-slate-100 border-b border-slate-200 dark:border-slate-700 pb-4 mb-5">Details & Optionen</h2>
                   
                   <div id="details-attachment-notice" style="padding:0.75rem; background-color:rgba(59, 130, 246, 0.1); border:1px solid rgba(59, 130, 246, 0.2); border-radius:0.5rem; font-size:0.875rem; margin-bottom:1rem;">
                      <div style="display: flex; gap: 0.75rem; alignItems: flex-start;">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" fill="currentColor" style="width: 1rem; height: 1rem; margin-top: 0.2rem; flex-shrink: 0;">
                              <path d="M364.2 83.8c-24.4-24.4-64-24.4-88.4 0l-184 184c-42.1 42.1-42.1 110.3 0 152.4s110.3 42.1 152.4 0l152-152c10.9-10.9 28.7-10.9 39.6 0s10.9 28.7 0 39.6l-152 152c-64 64-167.6 64-231.6 0s-64-167.6 0-231.6l184-184c46.3-46.3 121.3-46.3 167.6 0s46.3 121.3 0 167.6l-176 176c-28.6 28.6-75 28.6-103.6 0s-28.6-75 0-103.6l144-144c10.9-10.9 28.7-10.9 39.6 0s10.9 28.7 0 39.6l-144 144c-6.7 6.7-6.7 17.7 0 24.4s17.7 6.7 24.4 0l176-176c24.4-24.4 24.4-64 0-88.4z"/>
                          </svg>
                          <p style="margin:0;">
                              <strong>Anhänge:</strong> Dokumente wie eine eAU oder ein Attest erst in Outlook anhängen.
                          </p>
                      </div>
                   </div>

                   <label for="comments" class="mb-1.5 text-sm font-medium text-slate-600 dark:text-slate-400">Bemerkung / voraussichtliche Dauer</label>
                   <textarea id="comments" rows="3" class="w-full px-4 py-2.5 bg-white dark:bg-slate-700 text-slate-900 dark:text-white border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 transition duration-200"></textarea>
                   <div id="comment-presets-container" class="mt-2 space-y-2">
                      <!-- Presets injected by JS -->
                   </div>
                </div>
             </div>
          </div>

          <!-- Recipients Panel -->
          <div class="bg-white dark:bg-slate-800 rounded-xl shadow-lg">
             <div class="p-6">
                <div class="flex items-center justify-between border-b border-slate-200 dark:border-slate-700 pb-4 mb-5">
                    <h2 class="text-xl font-bold text-slate-800 dark:text-slate-100">Krankmelden bei</h2>
                    <div class="flex items-center">
                    </div>
                </div>
                <div id="recipients-list-container" class="max-h-80 overflow-y-auto pr-2 -mr-2 space-y-4">
                   <!-- Injected by JS -->
                </div>
             </div>
          </div>

        </div>

        <!-- Right Column: Preview -->
        <div class="lg:col-span-2">
          <div class="bg-white dark:bg-slate-800 rounded-xl shadow-lg sticky top-24">
             <div class="p-6">
                <h2 class="text-xl font-bold text-slate-800 dark:text-slate-100 border-b border-slate-200 dark:border-slate-700 pb-4 mb-5">Vorschau & E-Mail</h2>
                <div class="space-y-4">
                   <div>
                      <label class="text-sm font-semibold text-slate-600 dark:text-slate-300">Betreff</label>
                      <div class="mt-1 relative group">
                         <div id="preview-subject" class="p-3 pr-10 bg-slate-100 dark:bg-slate-700/50 rounded-lg text-sm text-slate-800 dark:text-slate-200 whitespace-pre-wrap break-words font-mono border border-slate-200 dark:border-slate-700 min-h-[3rem]"></div>
                         <button id="copy-subject-btn" class="absolute top-2 right-2 p-2 rounded-md bg-white/50 dark:bg-slate-800/50 text-slate-500 dark:text-slate-400 hover:bg-white dark:hover:bg-slate-600 hover:text-indigo-600 dark:hover:text-indigo-400 transition-all opacity-0 group-hover:opacity-100 focus:opacity-100" title="Kopieren">
                             <!-- Icon injected -->
                         </button>
                      </div>
                   </div>
                   <div>
                      <label class="text-sm font-semibold text-slate-600 dark:text-slate-300">An (To)</label>
                      <div class="mt-1 relative group">
                         <div id="preview-to" class="p-3 pr-10 bg-slate-100 dark:bg-slate-700/50 rounded-lg text-sm text-slate-800 dark:text-slate-200 whitespace-pre-wrap break-words font-mono border border-slate-200 dark:border-slate-700 min-h-[3rem]"></div>
                         <button id="copy-to-btn" class="absolute top-2 right-2 p-2 rounded-md bg-white/50 dark:bg-slate-800/50 text-slate-500 dark:text-slate-400 hover:bg-white dark:hover:bg-slate-600 hover:text-indigo-600 dark:hover:text-indigo-400 transition-all opacity-0 group-hover:opacity-100 focus:opacity-100" title="Kopieren">
                           <!-- Icon injected -->
                         </button>
                      </div>
                   </div>
                   <div>
                      <label class="text-sm font-semibold text-slate-600 dark:text-slate-300">Nachricht</label>
                      <div class="mt-1 relative group">
                         <textarea id="preview-body" class="w-full p-3 bg-slate-100 dark:bg-slate-700/50 rounded-lg text-sm text-slate-800 dark:text-slate-200 whitespace-pre-wrap break-words h-64 overflow-y-auto border border-slate-200 dark:border-slate-700 font-mono focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition duration-200"></textarea>
                         <button id="copy-body-btn" class="absolute top-2 right-2 p-2 rounded-md bg-white/50 dark:bg-slate-800/50 text-slate-500 dark:text-slate-400 hover:bg-white dark:hover:bg-slate-600 hover:text-indigo-600 dark:hover:text-indigo-400 transition-all opacity-0 group-hover:opacity-100 focus:opacity-100" title="Kopieren">
                           <!-- Icon injected -->
                         </button>
                      </div>
                   </div>
                </div>
             </div>
             
             <div class="bg-slate-50 dark:bg-slate-800/50 p-4 border-t border-slate-200 dark:border-slate-700 rounded-b-xl">
                <div class="relative group w-full">
                   <button id="open-outlook-btn" class="w-full inline-flex items-center justify-center px-4 py-3 border border-transparent text-base font-medium rounded-lg shadow-lg text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-slate-800 focus:ring-indigo-500 transition-transform hover:scale-[1.02] active:scale-[0.98] disabled:bg-indigo-400 dark:disabled:bg-indigo-500/50 disabled:cursor-not-allowed">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="currentColor" class="h-5 w-5 mr-3">
                         <path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480V396.4c0-4 1.5-7.8 4.2-10.7L331.8 202.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8 17.7 316.6C7.1 311.3 .3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.8-5.5 34 1.4z"/>
                      </svg>
                      E-Mail in Outlook öffnen
                   </button>
                   <div id="outlook-tooltip" class="hidden absolute bottom-full mb-2 w-max max-w-xs left-1/2 -translate-x-1/2 px-3 py-2 bg-slate-700 dark:bg-slate-800 text-white dark:text-slate-200 text-sm rounded-md shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none z-10">
                      Bitte fügen Sie mindestens einen Empfänger mit einer gültigen E-Mail-Adresse hinzu.
                      <svg class="absolute text-slate-700 dark:text-slate-800 h-2 w-full left-0 top-full" x="0px" y="0px" viewBox="0 0 255 255" xmlSpace="preserve"><polygon class="fill-current" points="0,0 127.5,127.5 255,0"/></svg>
                   </div>
                </div>
                
                <div class="relative group w-full mt-3">
                   <div class="grid grid-cols-2 gap-3">
                       <a id="btn-mail-android" href="#" target="_blank" rel="noopener noreferrer" class="w-full inline-flex items-center justify-center px-4 py-2 border border-slate-300 dark:border-slate-600 text-xs sm:text-sm font-medium rounded-md shadow-sm text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-700 hover:bg-slate-50 dark:hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-slate-800 focus:ring-indigo-500 transition-colors disabled:opacity-50">
                          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-slate-800 dark:text-slate-300" viewBox="0 0 576 512" fill="currentColor">
                              <path d="M420.55,301.93a24,24,0,1,1,24-24,24,24,0,0,1-24,24m-265.1,0a24,24,0,1,1,24-24,24,24,0,0,1-24,24m273.7-144.48,47.94-83a10,10,0,1,0-17.27-10h0l-48.54,84.07A301.25,301.25,0,0,0,288,135.76a301.32,301.32,0,0,0-123.29,12.76L116.18,64.45a10,10,0,1,0-17.27,10h0l47.94,83C64.53,202.22,8.24,285.55,0,384H576c-8.24-98.45-64.54-181.78-146.85-226.55"/>
                          </svg>
                          Mail (Android/PC)
                       </a>
                       <a id="btn-mail-ios" href="#" class="w-full inline-flex items-center justify-center px-4 py-2 border border-slate-300 dark:border-slate-600 text-xs sm:text-sm font-medium rounded-md shadow-sm text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-700 hover:bg-slate-50 dark:hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-slate-800 focus:ring-indigo-500 transition-colors disabled:opacity-50">
                          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-slate-800 dark:text-white" viewBox="0 0 384 512" fill="currentColor">
                              <path d="M318.7 268.7c-.2-36.7 16.4-64.4 50-84.8-18.8-26.9-47.2-41.7-84.7-44.6-35.5-2.8-74.3 20.7-88.5 20.7-15 0-49.4-19.7-76.4-19.7C63.3 141.2 4 184.8 4 273.5q0 39.3 14.4 81.2c12.8 36.7 59 126.7 107.2 125.2 25.2-.6 43-17.9 75.8-17.9 31.8 0 48.3 17.9 76.4 17.9 48.6-.7 90.4-82.5 102.6-119.3-65.2-30.7-61.7-90-61.7-91.9zm-56.6-164.2c27.3-32.4 24.8-61.9 24-72.5-24.1 1.4-52 16.4-67.9 34.9-17.5 19.8-27.8 44.3-25.6 71.9 26.1 2 49.9-11.4 69.5-34.3z"/>
                          </svg>
                          Outlook (iOS)
                       </a>
                   </div>
                </div>
             </div>
          </div>
        </div>
      </div>
    </main>

    <footer class="py-4 text-center opacity-10 hover:opacity-100 transition-opacity duration-500">
       <div class="text-xs font-mono text-slate-500">
          v1.1.2
       </div>
    </footer>

    <!-- Load Scripts sequentially -->
    <script src="js/utils.js"></script>
    <script src="js/state.js"></script>
    <script src="js/colors.js"></script>
    <script src="js/builder.js"></script>
    <script src="js/preview.js"></script>
    <script src="js/app.js"></script>
  <script type="module" src="/index.tsx"></script>
</body>
</html>